<!DOCTYPE html>
<html>
<head>
  <title>Change Password</title>
  <style>
    body { 
      font-family: sans-serif; 
      max-width: 400px; 
      margin: auto; 
      padding: 20px; 
    }
    input, button { 
      margin: 5px 0; 
      padding: 8px; 
      width: 100%; 
    }
    button { 
      background: #333; 
      color: white; 
      border: none; 
      cursor: pointer; 
    }
  </style>
</head>
<body>
  <h2>Change Password</h2>
  <input type="password" id="oldPass" placeholder="Old Password">
  <input type="password" id="newPass" placeholder="New Password">
  <button onclick="changePassword()">Change Password</button>

  <script>
    const auth = '/api/accounts';

    function getToken() {
      return localStorage.getItem('access');
    }

    async function changePassword() {
      const res = await fetch(`${auth}/change-password/`, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${getToken()}`
        },
        body: JSON.stringify({
          old_password: oldPass.value,
          new_password: newPass.value
        })
      });
      if (res.ok) {
        alert('Password changed successfully!');
      } else {
        const error = await res.json();
        alert('Failed: ' + (error.detail || 'Old Password not match'));
      }
    }
  </script>
</body>
</html>
